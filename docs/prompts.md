---

## üìÑ `docs/PROMPT.md`

```markdown
# –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–æ–µ–∫—Ç–∞ –¥–ª—è –ò–ò-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞

## üéØ –¶–µ–ª—å

–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–Ω—Å–æ–ª—å–Ω–æ–≥–æ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è 1–° —Å –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–π –¥–æ–º–µ–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π. –ö–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å ‚Äî –∞–≤—Ç–æ–Ω–æ–º–Ω–∞—è –ø–æ–¥—Å–∏—Å—Ç–µ–º–∞ —Å –ø–æ–ª–Ω–æ–π –∏–∑–æ–ª—è—Ü–∏–µ–π.

## üìö –°–ø—Ä–∞–≤–æ—á–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç)

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –Ω–∞ –¥–≤—É—Ö —É—Ä–æ–≤–Ω—è—Ö –¥–ª—è –ø–æ–∫—Ä—ã—Ç–∏—è –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

| –£—Ä–æ–≤–µ–Ω—å                      | –ù–æ—Å–∏—Ç–µ–ª—å          | –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å                              | –ü—Ä–∏–º–µ—Ä –¥–æ—Å—Ç—É–ø–∞                        |
| ---------------------------- | ----------------- | -------------------------------------------- | ------------------------------------- |
| **–ö–æ–Ω—Å–æ–ª—å–Ω–∞—è —Å–ø—Ä–∞–≤–∫–∞**       | `orchestrator.py` | –ë—ã—Å—Ç—Ä—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –∫–æ–º–∞–Ω–¥, —Ñ–ª–∞–≥–∏, –ø—Ä–∏–º–µ—Ä—ã     | `ib_1c help`<br>`ib_1c backup --help` |
| **–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** | `docs/*.md`       | –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, —Å—Ü–µ–Ω–∞—Ä–∏–∏, –ø—Ä–∏–º–µ—Ä—ã —Å –ø–æ—è—Å–Ω–µ–Ω–∏—è–º–∏ | `/opt/1cv8/scripts/docs/README.md`    |

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–æ–Ω—Å–æ–ª—å–Ω–æ–π —Å–ø—Ä–∞–≤–∫–µ

| –ö–æ–º–∞–Ω–¥–∞                     | –ü–æ–≤–µ–¥–µ–Ω–∏–µ                                     | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è                                       |
| --------------------------- | --------------------------------------------- | ------------------------------------------------ |
| `ib_1c` (–±–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤)    | –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–¥–∫–æ–º–∞–Ω–¥ —Å –∫—Ä–∞—Ç–∫–∏–º –æ–ø–∏—Å–∞–Ω–∏–µ–º | `argparse` —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –∞—Ä–≥—É–º–µ–Ω—Ç–∞     |
| `ib_1c help`                | –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–¥–∫–æ–º–∞–Ω–¥ —Å –∫—Ä–∞—Ç–∫–∏–º –æ–ø–∏—Å–∞–Ω–∏–µ–º | –ü–æ–¥–∫–æ–º–∞–Ω–¥–∞ `help` –≤ `orchestrator.py`            |
| `ib_1c <subcommand> --help` | –î–µ—Ç–∞–ª—å–Ω–∞—è —Å–ø—Ä–∞–≤–∫–∞ –ø–æ –ø–æ–¥–∫–æ–º–∞–Ω–¥–µ               | –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π `argparse.ArgumentParser` –≤ –∞–¥–∞–ø—Ç–µ—Ä–µ |

> üí° **–ü—Ä–∏–Ω—Ü–∏–ø:** –ö–æ–Ω—Å–æ–ª—å–Ω–∞—è —Å–ø—Ä–∞–≤–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å–∞–º–æ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –±–∞–∑–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –±–µ–∑ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ `.md` —Ñ–∞–π–ª–∞–º.

## üì¶ –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è –¥–æ–º–µ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (—Ü–µ–ª–µ–≤–∞—è)

scripts/
‚îú‚îÄ‚îÄ orchestrator.py # CLI-–º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä (–µ–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ + —Å–ø—Ä–∞–≤–∫–∞)
‚îú‚îÄ‚îÄ config/
‚îÇ ‚îî‚îÄ‚îÄ global.sh # –û–±—â–∏–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (PG_HOST, PG_PORT, BACKUP_ROOT, SSH_KEY)
‚îú‚îÄ‚îÄ core/ # –û–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã (–±–µ–∑ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏)
‚îÇ ‚îú‚îÄ‚îÄ engine.py # run_engine(script, args, capture_output=True)
‚îÇ ‚îú‚îÄ‚îÄ utils.py # color(), –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ ‚îî‚îÄ‚îÄ exceptions.py # AppError, ConfigError
‚îú‚îÄ‚îÄ ib_list.conf # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–ø–∏—Å–æ–∫ –ò–ë (–∫—ç—à –∏–∑ –∫–ª–∞—Å—Ç–µ—Ä–∞)
‚îú‚îÄ‚îÄ .version # –í–µ—Ä—Å–∏—è —Å–∏—Å—Ç–µ–º—ã
‚îÇ
‚îú‚îÄ‚îÄ backup/ # üì¶ –î–æ–º–µ–Ω: –±—ç–∫–∞–ø—ã
‚îÇ ‚îú‚îÄ‚îÄ engines/
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ backup.sh # pg_dump —á–µ—Ä–µ–∑ SSH
‚îÇ ‚îú‚îÄ‚îÄ services/
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ init.py # –ü—É—Å—Ç–æ–π –º–∞—Ä–∫–µ—Ä –º–æ–¥—É–ª—è
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ backup_service.py # backup_ib(ib_name, format_type, dry_run=False)
‚îÇ ‚îî‚îÄ‚îÄ adapters/cli/
‚îÇ ‚îú‚îÄ‚îÄ init.py # –ü—É—Å—Ç–æ–π –º–∞—Ä–∫–µ—Ä –º–æ–¥—É–ª—è
‚îÇ ‚îî‚îÄ‚îÄ backup_adapter.py # argparse ‚Üí backup_service ‚Üí –≤—ã–≤–æ–¥ + --help
‚îÇ
‚îú‚îÄ‚îÄ rm/ # üóëÔ∏è –î–æ–º–µ–Ω: —É–¥–∞–ª–µ–Ω–∏–µ
‚îÇ ‚îú‚îÄ‚îÄ engines/
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ rm.sh # –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –±—ç–∫–∞–ø–æ–≤
‚îÇ ‚îú‚îÄ‚îÄ services/
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ init.py
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ rm_service.py # rm_ib(ib_name, timestamp=None, older_than=None, confirm=False)
‚îÇ ‚îî‚îÄ‚îÄ adapters/cli/
‚îÇ ‚îú‚îÄ‚îÄ init.py
‚îÇ ‚îî‚îÄ‚îÄ rm_adapter.py # argparse ‚Üí rm_service ‚Üí –≤—ã–≤–æ–¥ + --help
‚îÇ
‚îî‚îÄ‚îÄ storage/ # üíæ –î–æ–º–µ–Ω: –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ + —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–æ–º –ò–ë
‚îú‚îÄ‚îÄ engines/
‚îÇ ‚îú‚îÄ‚îÄ disk_usage.sh # df -h –≤ –ø–∞—Ä—Å–∏–º–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
‚îÇ ‚îú‚îÄ‚îÄ list_backups.sh # –°–ø–∏—Å–æ–∫ –±—ç–∫–∞–ø–æ–≤ (TSV: timestamp size path)
‚îÇ ‚îú‚îÄ‚îÄ count_backups.sh # –ü–æ–¥—Å—á—ë—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞/—Ä–∞–∑–º–µ—Ä–∞ –ø–æ –ò–ë
‚îÇ ‚îú‚îÄ‚îÄ validate.sh # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
‚îÇ ‚îî‚îÄ‚îÄ list_ibs.sh # rac cluster list infobases (–ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ò–ë –∏–∑ –∫–ª–∞—Å—Ç–µ—Ä–∞)
‚îú‚îÄ‚îÄ services/
‚îÇ ‚îú‚îÄ‚îÄ init.py
‚îÇ ‚îî‚îÄ‚îÄ storage_service.py # get_usage(), get_ib_stats(), get_ib_list_from_cluster(), update_ib_list(confirm=False)
‚îî‚îÄ‚îÄ adapters/cli/
‚îú‚îÄ‚îÄ init.py
‚îî‚îÄ‚îÄ storage_adapter.py # storage, list-ibs, update-ib-list + --help
```

## üîë –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

| –ü—Ä–∏–Ω—Ü–∏–ø                     | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è                                                                                 |
| --------------------------- | ------------------------------------------------------------------------------------------ |
| **–ò–∑–æ–ª—è—Ü–∏—è –¥–æ–º–µ–Ω–æ–≤**        | `backup/` –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç `rm/` –∏–ª–∏ `storage/`; –≤—Å–µ –¥–æ–º–µ–Ω—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ç–æ–ª—å–∫–æ `core/`         |
| **–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–ø–∏—Å–æ–∫ –ò–ë**   | `backup/` –∏ `rm/` —á–∏—Ç–∞—é—Ç —Ç–æ–ª—å–∫–æ `ib_list.conf` (–ù–ï –≤—ã–∑—ã–≤–∞—é—Ç `storage/`)                    |
| **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–æ–º –ò–ë**   | `storage/` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —É—Ç–∏–ª–∏—Ç—É `update-ib-list` –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è `ib_list.conf`            |
| **–ó–∞—â–∏—Ç–∞ –æ—Ç —É–¥–∞–ª–µ–Ω–∏—è –ò–ë**   | –£–¥–∞–ª–µ–Ω–∏–µ –ò–ë –∏–∑ `ib_list.conf` —Ç—Ä–µ–±—É–µ—Ç `--confirm` (–ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä–∏ –∏—Å—Ç–æ—Ä–∏–∏ –±—ç–∫–∞–ø–æ–≤)  |
| **–ß–∏—Å—Ç–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞**    | `services/*_service.py` –Ω–µ –∑–Ω–∞–µ—Ç –ø—Ä–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã (CLI/Web/Telegram)                         |
| **–¢–æ–Ω–∫–∏–µ –∞–¥–∞–ø—Ç–µ—Ä—ã**         | `adapters/cli/*_adapter.py` —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –ø–∞—Ä—Å–∏–Ω–≥ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤, —Å–ø—Ä–∞–≤–∫—É (`--help`) –∏ –≤—ã–≤–æ–¥ |
| **–ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—ã–∑–æ–≤–∞**     | –í—Å–µ –¥–≤–∏–∂–∫–∏ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `core.engine.run_engine()`                                    |
| **–ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å**      | –í –ø—É–±–ª–∏—á–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¢–û–õ–¨–ö–û —Ç–µ—Å—Ç–æ–≤—ã–µ –ò–ë: `test_db`, `db_test`             |
| **–°–∞–º–æ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è —Å–ø—Ä–∞–≤–∫–∞** | `ib_1c help` –∏ `ib_1c <subcommand> --help` –ø–æ–∫—Ä—ã–≤–∞—é—Ç 90% —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –±–µ–∑ `.md`               |

## ‚ö†Ô∏è –ó–∞–ø—Ä–µ—â–µ–Ω–æ

- –î—É–±–ª–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –∏–∑ `core/` –≤ –¥–æ–º–µ–Ω—ã
- –•—Ä–∞–Ω–∏—Ç—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥–∞—Ö
- –î–æ–±–∞–≤–ª—è—Ç—å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –≤ `core/`
- –°–æ–∑–¥–∞–≤–∞—Ç—å –∫—Ä–æ—Å—Å-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –¥–æ–º–µ–Ω–∞–º–∏ (`backup/` ‚Üí `storage/`)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—Ç—å –ò–ë –∏–∑ `ib_list.conf` –±–µ–∑ `--confirm`
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ –ò–ë –≤ –ø—É–±–ª–∏—á–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ (—Ç–æ–ª—å–∫–æ `test_db`, `db_test`)
- –û—Å—Ç–∞–≤–ª—è—Ç—å –ø–æ–¥–∫–æ–º–∞–Ω–¥—ã –±–µ–∑ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ `--help`

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ `core/`

–õ—é–±–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤ `core/` —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –í–°–ï–• –¥–æ–º–µ–Ω–æ–≤:

```bash
ib_1c help
ib_1c backup --ib test_db --format dump --dry-run
ib_1c rm --ib test_db --timestamp 20260206_124957 --dry-run
ib_1c storage
ib_1c storage list-ibs
ib_1c storage update-ib-list --dry-run
```

# üì• –§–æ—Ä–º–∞—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∫–æ–¥–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

[–§–∞–π–ª] /–ø—É—Ç—å/–∫/—Ñ–∞–π–ª—É.py

```python
–∫–æ–¥ –∑–¥–µ—Å—å


–ò–õ–ò –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:

```

[–°—Ç—Ä—É–∫—Ç—É—Ä–∞] /–ø—É—Ç—å/–∫/–ø–∞–ø–∫–µ/
–ø–∞–ø–∫–∞/
‚îú‚îÄ‚îÄ –ø–æ–¥–ø–∞–ø–∫–∞/
‚îî‚îÄ‚îÄ —Ñ–∞–π–ª.py
---[–§–∞–π–ª] /–ø—É—Ç—å/–∫/—Ñ–∞–π–ª—É.py---

–∫–æ–¥

## üöß –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

| –î–æ–º–µ–Ω             | –°—Ç–∞—Ç—É—Å                                  | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ                                                    |
| ----------------- | --------------------------------------- | ------------------------------------------------------------- |
| `backup`          | ‚úÖ –†–∞–±–æ—á–∏–π (–≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞) | –¢—Ä–µ–±—É–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É                     |
| `rm`              | ‚úÖ –†–∞–±–æ—á–∏–π (–≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞) | –¢—Ä–µ–±—É–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É                     |
| `storage`         | üü° –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ                         | –¢—Ä–µ–±—É–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ + –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ `list_ibs.sh`, `update-ib-list` |
| `core/`           | ‚úÖ –°—Ç–∞–±–∏–ª–µ–Ω                             | –ö–æ–Ω—Ç—Ä–∞–∫—Ç `run_engine()` –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω                          |
| `orchestrator.py` | üü° –¢—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏                    | –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É `ib_1c help` –∏ `ib_1c` (–±–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤)    |
